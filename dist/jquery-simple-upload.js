!function(n){var o={};function a(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,a),t.l=!0,t.exports}a.m=n,a.c=o,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(n,o,function(e){return t[e]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/dist",a(a.s=2)}([function(e){e.exports=jQuery},function(){},function(e,t,n){"use strict";n.r(t);var o=n(0),i=n.n(o),r="simple-upload";function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],o=!0,a=!1,r=void 0;try{for(var i,s=e[Symbol.iterator]();!(o=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);o=!0);}catch(e){a=!0,r=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw r}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var l={url:"",method:"post",headers:{},dataType:null,params:{},timeout:0,async:!0,dropZone:null,progress:null,maxFileSize:null,maxFileNum:null,allowedFileName:null,allowedMimeType:null},a=function(){function a(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),this.options=i.a.extend({},l,t),this.$input=i()(e),this.$dropZone=i()(this.options.dropZone),this.$progress=i()(this.options.progress),this.uid=(new Date).getTime()+Math.random(),this.namespace="".concat(r,"-").concat(this.uid),this.dragCounter=0,this.init()}return function(e,t,n){t&&u(e.prototype,t),n&&u(e,n)}(a,[{key:"init",value:function(){this.$input.addClass(r),this.$dropZone.addClass(r).addClass("simple-upload-droppable"),this.$progress.addClass(r),this.unbind(),this.bind()}},{key:"destroy",value:function(){this.$input.removeClass(r),this.$dropZone.removeClass(r).removeClass("simple-upload-droppable"),this.$progress.removeClass(r),this.unbind()}},{key:"bind",value:function(){var t=this;this.$input.on("change.".concat(this.namespace),function(e){t.process(e.target.files),e.target.value=""}),this.$dropZone.length&&(this.$dropZone.on("drop.".concat(r),function(e){e.preventDefault(),e.stopPropagation(),t.dragCounter=0,t.$dropZone.removeClass("simple-upload-dragover"),t.process(e.originalEvent.dataTransfer.files)}).on("dragenter.".concat(r),function(e){e.preventDefault(),t.dragCounter++,t.$dropZone.addClass("simple-upload-dragover")}).on("dragleave.".concat(r),function(e){e.preventDefault(),t.dragCounter--,0==t.dragCounter&&t.$dropZone.removeClass("simple-upload-dragover")}),i()(document).on("drop.".concat(this.namespace),function(e){e.preventDefault()}).on("dragover.".concat(this.namespace),function(e){e.preventDefault()}))}},{key:"unbind",value:function(){this.$input.off(".".concat(this.namespace)),this.$dropZone.off(".".concat(this.namespace)),i()(document).off(".".concat(this.namespace));var e=i.a._data(this.$input.get(0),"events");if(e){var t=Object.keys(e).filter(function(e){return e.match(/^upload:/)});this.$input.off(t.join(" "))}}},{key:"process",value:function(e){if(!this.$input.prop("disabled"))if(this.options.maxFileNum&&e.length>this.options.maxFileNum)this.$input.trigger("upload:over",[e]);else{var t=s(this.validate(e),2),n=t[0],o=t[1];0<o.length&&this.$input.trigger("upload:invalid",[o]),0<n.length&&this.uploadFiles(n)}}},{key:"validate",value:function(e){for(var t=[],n=[],o=0;o<e.length;o++){var a=e[o];this.options.maxFileSize&&a.size>this.options.maxFileSize?(a.reason="size",n.push(a)):this.options.allowedFileName&&!a.name.match(this.options.allowedFileName)?(a.reason="name",n.push(a)):this.options.allowedMimeType&&!a.type.match(this.options.allowedMimeType)?(a.reason="type",n.push(a)):t.push(a)}return[t,n]}},{key:"uploadFiles",value:function(t){var n=this;this.$input.prop("disabled",!0),this.before(t);for(var o=(new i.a.Deferred).resolve(),e=function(e){o=o.then(function(){return n.uploadFile(t[e],e)})},a=0;a<t.length;a++)e(a);o.then(function(){n.after(t),n.$input.prop("disabled",!1)})}},{key:"uploadFile",value:function(o,a){var r=this,e=new i.a.Deferred;return i.a.ajax({url:this.options.url,method:this.options.method,headers:this.options.headers,dataType:this.options.dataType,data:this.buildFormData(o),timeout:this.options.timeout,async:this.options.async,processData:!1,contentType:!1,beforeSend:function(){r.start(o,a)},xhr:function(){var e=i.a.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",function(e){r.progress(o,a,e.loaded,e.total)},!1),e}}).done(function(e,t,n){r.done(o,a,e,t,n)}).fail(function(e,t,n){r.fail(o,a,e,t,n)}).always(function(){r.end(o,a),e.resolve()}),e.promise()}},{key:"before",value:function(e){var n=this;this.$progress.length&&e.forEach(function(e,t){n.buildProgress(e,t)}),this.$input.trigger("upload:before",[e])}},{key:"after",value:function(e){this.$input.trigger("upload:after",[e])}},{key:"start",value:function(e,t){this.$input.trigger("upload:start",[e,t])}},{key:"progress",value:function(e,t,n,o){this.findProgress(t).find(".simple-upload-percent").text(Math.ceil(n/o*100)+"%"),this.$input.trigger("upload:progress",[e,t,n,o])}},{key:"done",value:function(e,t,n,o,a){this.$input.trigger("upload:done",[e,t,n,o,a])}},{key:"fail",value:function(e,t,n,o,a){this.$input.trigger("upload:fail",[e,t,n,o,a])}},{key:"end",value:function(e,t){this.findProgress(t).hide("fast",function(e){return i()(e).remove()}),this.$input.trigger("upload:end",[e,t])}},{key:"buildProgress",value:function(e,t){var n=i()("<div>").addClass("simple-upload-progress").data("upload-index",t);i()("<span>").addClass("simple-upload-filename").text(e.name).appendTo(n),i()("<span>").addClass("simple-upload-percent").text("...").appendTo(n),this.$progress.append(n)}},{key:"findProgress",value:function(n){return this.$progress.find(".simple-upload-progress").filter(function(e,t){return i()(t).data("upload-index")==n})}},{key:"buildFormData",value:function(e){var t=new FormData;t.append(this.$input.attr("name"),e);var n=a.makeParams(this.options.params);for(var o in n)t.append(o,n[o]);return t}}],[{key:"makeParams",value:function(e){var t={};switch(Object.prototype.toString.call(e)){case"[object Function]":t=e();break;case"[object Array]":e.forEach(function(e){t[e.name]=e.value});break;case"[object Object]":i.a.extend(t,e)}return t}},{key:"getDefaults",value:function(){return l}},{key:"setDefaults",value:function(e){return i.a.extend(l,e)}}]),a}();n(1);i.a.fn.simpleUpload=function(o){return this.each(function(e,t){var n=i()(t);n.data(r)&&n.data(r).destroy(),n.data(r,new a(n,o))})},i.a.SimpleUpload=a}]);