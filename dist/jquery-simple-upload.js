!function(n){var a={};function o(e){if(a[e])return a[e].exports;var t=a[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=n,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(n,a,function(e){return t[e]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/dist",o(o.s=2)}([function(e){e.exports=jQuery},function(){},function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i="simple-upload";function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,o=!1,i=void 0;try{for(var r,s=e[Symbol.iterator]();!(a=(r=s.next()).done)&&(n.push(r.value),!t||n.length!==t);a=!0);}catch(e){o=!0,i=e}finally{try{a||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function u(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var l={url:"",method:"post",headers:{},dataType:null,params:{},timeout:0,async:!0,dropZone:null,progress:null,validator:null,maxFileSize:null,maxFileNum:null,allowedFileName:null,allowedMimeType:null},o=function(){function o(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),this.options=r.a.extend({},l,t),this.$input=r()(e),this.$dropZone=r()(this.options.dropZone),this.$progress=r()(this.options.progress),this.uid=(new Date).getTime()+Math.random(),this.namespace="".concat(i,"-").concat(this.uid),this.dragCounter=0,this.init()}return function(e,t,n){t&&u(e.prototype,t),n&&u(e,n)}(o,[{key:"init",value:function(){this.$input.addClass(i),this.$dropZone.addClass(i).addClass("simple-upload-droppable"),this.$progress.addClass(i),this.unbind(),this.bind()}},{key:"destroy",value:function(){this.$input.removeClass(i),this.$dropZone.removeClass(i).removeClass("simple-upload-droppable"),this.$progress.removeClass(i),this.unbind()}},{key:"bind",value:function(){var t=this;this.$input.on("change.".concat(this.namespace),function(e){t.process(e.target.files),e.target.value=""}),this.$dropZone.length&&(this.$dropZone.on("drop.".concat(this.namespace),function(e){e.preventDefault(),e.stopPropagation(),t.dragCounter=0,t.$dropZone.removeClass("simple-upload-dragover"),t.process(e.originalEvent.dataTransfer.files)}).on("dragenter.".concat(this.namespace),function(e){e.preventDefault(),t.dragCounter++,t.$dropZone.addClass("simple-upload-dragover")}).on("dragleave.".concat(this.namespace),function(e){e.preventDefault(),t.dragCounter--,0==t.dragCounter&&t.$dropZone.removeClass("simple-upload-dragover")}),r()(document).on("drop.".concat(this.namespace),function(e){e.preventDefault()}).on("dragover.".concat(this.namespace),function(e){e.preventDefault()}))}},{key:"unbind",value:function(){this.$input.off(".".concat(this.namespace)),this.$dropZone.off(".".concat(this.namespace)),r()(document).off(".".concat(this.namespace));var e=r.a._data(this.$input.get(0),"events");if(e){var t=Object.keys(e).filter(function(e){return e.match(/^upload:/)});this.$input.off(t.join(" "))}}},{key:"process",value:function(e){if(!this.$input.prop("disabled"))if(this.options.maxFileNum&&e.length>this.options.maxFileNum)this.$input.trigger("upload:over",[e]);else{var t=e;this.options.validator&&(t=this.options.validator(t));var n=s(this.validate(t),2),a=n[0],o=n[1];0<o.length&&this.$input.trigger("upload:invalid",[o]),0<a.length&&this.uploadFiles(a)}}},{key:"validate",value:function(e){for(var t=[],n=[],a=0;a<e.length;a++){var o=e[a];this.options.maxFileSize&&o.size>this.options.maxFileSize?(o.reason="size",n.push(o)):this.options.allowedFileName&&!o.name.match(this.options.allowedFileName)?(o.reason="name",n.push(o)):this.options.allowedMimeType&&!o.type.match(this.options.allowedMimeType)?(o.reason="type",n.push(o)):t.push(o)}return[t,n]}},{key:"uploadFiles",value:function(t){var n=this;this.$input.prop("disabled",!0),this.before(t);for(var a=(new r.a.Deferred).resolve(),e=function(e){a=a.then(function(){return n.uploadFile(t[e],e)})},o=0;o<t.length;o++)e(o);a.then(function(){n.after(t),n.$input.prop("disabled",!1)})}},{key:"uploadFile",value:function(a,o){var i=this,e=new r.a.Deferred;return r.a.ajax({url:this.options.url,method:this.options.method,headers:this.options.headers,dataType:this.options.dataType,data:this.buildFormData(a),timeout:this.options.timeout,async:this.options.async,processData:!1,contentType:!1,beforeSend:function(){i.start(a,o)},xhr:function(){var e=r.a.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",function(e){i.progress(a,o,e.loaded,e.total)},!1),e}}).done(function(e,t,n){i.done(a,o,e,t,n)}).fail(function(e,t,n){i.fail(a,o,e,t,n)}).always(function(){i.end(a,o),e.resolve()}),e.promise()}},{key:"before",value:function(e){var n=this;this.$progress.length&&e.forEach(function(e,t){n.buildProgress(e,t)}),this.$input.trigger("upload:before",[e])}},{key:"after",value:function(e){this.$input.trigger("upload:after",[e])}},{key:"start",value:function(e,t){this.$input.trigger("upload:start",[e,t])}},{key:"progress",value:function(e,t,n,a){this.findProgress(t).find(".simple-upload-percent").text(Math.ceil(n/a*100)+"%"),this.$input.trigger("upload:progress",[e,t,n,a])}},{key:"done",value:function(e,t,n,a,o){this.$input.trigger("upload:done",[e,t,n,a,o])}},{key:"fail",value:function(e,t,n,a,o){this.$input.trigger("upload:fail",[e,t,n,a,o])}},{key:"end",value:function(e,t){this.findProgress(t).hide("fast",function(e){return r()(e).remove()}),this.$input.trigger("upload:end",[e,t])}},{key:"buildProgress",value:function(e,t){var n=r()("<div>").addClass("simple-upload-progress").data("upload-index",t);r()("<span>").addClass("simple-upload-filename").text(e.name).appendTo(n),r()("<span>").addClass("simple-upload-percent").text("...").appendTo(n),this.$progress.append(n)}},{key:"findProgress",value:function(n){return this.$progress.find(".simple-upload-progress").filter(function(e,t){return r()(t).data("upload-index")==n})}},{key:"buildFormData",value:function(e){var t=new FormData;t.append(this.$input.attr("name"),e);var n=o.makeParams(this.options.params);for(var a in n)t.append(a,n[a]);return t}}],[{key:"makeParams",value:function(e){var t={};switch(Object.prototype.toString.call(e)){case"[object Function]":t=e();break;case"[object Array]":e.forEach(function(e){t[e.name]=e.value});break;case"[object Object]":r.a.extend(t,e)}return t}},{key:"getDefaults",value:function(){return l}},{key:"setDefaults",value:function(e){return r.a.extend(l,e)}}]),o}();n(1);r.a.fn.simpleUpload=function(a){return this.each(function(e,t){var n=r()(t);n.data(i)&&n.data(i).destroy(),n.data(i,new o(n,a))})},r.a.SimpleUpload=o}]);